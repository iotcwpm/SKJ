<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.5">
  <compounddef id="checks__estimated__subcatch_8py" kind="file">
    <compoundname>checks_estimated_subcatch.py</compoundname>
    <innerclass refid="classtangagroomer_1_1checks__estimated__subcatch_1_1ESSTA" prot="public">tangagroomer::checks_estimated_subcatch::ESSTA</innerclass>
    <innerclass refid="classtangagroomer_1_1checks__estimated__subcatch_1_1ESCWN" prot="public">tangagroomer::checks_estimated_subcatch::ESCWN</innerclass>
    <innernamespace refid="namespacetangagroomer_1_1checks__estimated__subcatch">tangagroomer::checks_estimated_subcatch</innernamespace>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1" refid="namespacetangagroomer_1_1checks__estimated__subcatch" refkind="compound"><highlight class="keyword">from</highlight><highlight class="normal"><sp/>check<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>*</highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight></codeline>
<codeline lineno="3" refid="classtangagroomer_1_1checks__estimated__subcatch_1_1ESSTA" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classtangagroomer_1_1checks__estimated__subcatch_1_1ESSTA" kindref="compound">ESSTA</ref>(<ref refid="classtangagroomer_1_1check_1_1CHSTA" kindref="compound">CHSTA</ref>):</highlight></codeline>
<codeline lineno="4"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>table<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;estimated_subcatch&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="6"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classtangagroomer_1_1checks__estimated__subcatch_1_1ESSTA_1a71b65949c4278157b387566745dba7b4" kindref="member">do</ref>(self):</highlight></codeline>
<codeline lineno="7"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CHSTA.do(self)</highlight></codeline>
<codeline lineno="8"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="9" refid="classtangagroomer_1_1checks__estimated__subcatch_1_1ESCWN" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classtangagroomer_1_1checks__estimated__subcatch_1_1ESCWN" kindref="compound">ESCWN</ref>(<ref refid="classtangagroomer_1_1check_1_1Check" kindref="compound">Check</ref>):</highlight></codeline>
<codeline lineno="10"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>table<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;estimated_subcatch&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="11"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>brief<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;Estimated<sp/>catch<sp/>is<sp/>recorded<sp/>as<sp/>numbers<sp/>not<sp/>weight&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="12"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>desc<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&apos;&apos;Should<sp/>only<sp/>be<sp/>run<sp/>for<sp/>species<sp/>that<sp/>use<sp/>count<sp/>for<sp/>catch_weight<sp/>(tuna<sp/>species<sp/>and<sp/>others?)&apos;&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="13"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="14"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classtangagroomer_1_1checks__estimated__subcatch_1_1ESCWN_1adfa757533e8a3face54ce257a7081212" kindref="member">do</ref>(self):</highlight></codeline>
<codeline lineno="15"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.db.Execute(</highlight><highlight class="stringliteral">&apos;&apos;&apos;DROP<sp/>TABLE<sp/>IF<sp/>EXISTS<sp/>check_ESCWN&apos;&apos;&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="16"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.db.Execute(</highlight><highlight class="stringliteral">&apos;&apos;&apos;CREATE<sp/>TABLE<sp/>check_ESCWN<sp/>(species<sp/>TEXT,records<sp/>INTEGER);&apos;&apos;&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="17"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">##For<sp/>each<sp/>species<sp/>in<sp/>the<sp/>estimated_subcatch<sp/>table</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="18"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>species,count<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.db.Rows(</highlight><highlight class="stringliteral">&apos;&apos;&apos;SELECT<sp/>species_code,count(*)<sp/>FROM<sp/>estimated_subcatch<sp/>WHERE<sp/>species_code<sp/>IN<sp/>(&apos;ALB&apos;)<sp/>GROUP<sp/>BY<sp/>species_code<sp/>ORDER<sp/>BY<sp/>count(*)<sp/><sp/>DESC;&apos;&apos;&apos;</highlight><highlight class="normal">):<sp/></highlight></codeline>
<codeline lineno="19"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.db.Execute(</highlight><highlight class="stringliteral">&apos;&apos;&apos;INSERT<sp/>INTO<sp/>check_ESCWN<sp/>VALUES(?,?);&apos;&apos;&apos;</highlight><highlight class="normal">,(species,count))</highlight></codeline>
<codeline lineno="20"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">##Compare<sp/>each<sp/>trips<sp/>estimated<sp/>catch<sp/>to<sp/>landed<sp/>green<sp/>weight<sp/>to<sp/>see<sp/>if<sp/>it<sp/>lies<sp/>below<sp/>minimum.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">##If<sp/>it<sp/>does<sp/>then<sp/>it<sp/>is<sp/>assumed<sp/>to<sp/>represent<sp/>a<sp/>weight<sp/>and<sp/>so<sp/>is<sp/>converted<sp/>using<sp/>the<sp/>average<sp/>value</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="22"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>minimum,average<sp/>=<sp/>self.dataset.groom_estimated_subcatch_catch[species]<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="23"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">##I<sp/>found<sp/>it<sp/>necessary<sp/>to<sp/>create<sp/>temporary<sp/>tables<sp/>with<sp/>indices<sp/>on<sp/>them<sp/>to<sp/>get<sp/>adequate<sp/>execution<sp/>times.<sp/><sp/>Using<sp/>subqueries<sp/>was<sp/>much<sp/>slower!</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="24"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.db.Script(</highlight><highlight class="stringliteral">&apos;&apos;&apos;</highlight></codeline>
<codeline lineno="25"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CREATE<sp/>TEMPORARY<sp/>TABLE<sp/>check_ESCWN_%(species)s_g<sp/>AS<sp/>SELECT<sp/>trip,sum(green_weight)<sp/>AS<sp/>sum_green_weight<sp/>FROM<sp/>landing<sp/>WHERE<sp/>species_code=&apos;%(species)s&apos;<sp/>AND<sp/>trip<sp/>IS<sp/>NOT<sp/>NULL<sp/>GROUP<sp/>BY<sp/>trip;</highlight></codeline>
<codeline lineno="26"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CREATE<sp/>INDEX<sp/>check_ESCWN_%(species)s_g_trip<sp/>ON<sp/>check_ESCWN_%(species)s_g(trip);</highlight></codeline>
<codeline lineno="27"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="28"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CREATE<sp/>TEMPORARY<sp/>TABLE<sp/>check_ESCWN_%(species)s_c<sp/>AS<sp/>SELECT<sp/>trip,sum(estimated_subcatch.catch_weight)<sp/>AS<sp/>sum_catch_weight<sp/>FROM<sp/>fishing_event,estimated_subcatch<sp/>WHERE<sp/>fishing_event.event_key=estimated_subcatch.event_key<sp/>AND<sp/>species_code=&apos;%(species)s&apos;<sp/>AND<sp/>trip<sp/>IS<sp/>NOT<sp/>NULL<sp/>GROUP<sp/>BY<sp/>trip;</highlight></codeline>
<codeline lineno="29"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CREATE<sp/>INDEX<sp/>check_ESCWN_%(species)s_c_trip<sp/>ON<sp/>check_ESCWN_%(species)s_c(trip);</highlight></codeline>
<codeline lineno="30"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="31"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DROP<sp/>TABLE<sp/>IF<sp/>EXISTS<sp/>check_ESCWN_%(species)s;</highlight></codeline>
<codeline lineno="32"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CREATE<sp/>TABLE<sp/>check_ESCWN_%(species)s<sp/>AS<sp/>SELECT<sp/>g.trip<sp/>AS<sp/>trip,sum_green_weight,sum_catch_weight<sp/>FROM<sp/>check_ESCWN_%(species)s_g<sp/>AS<sp/>g,<sp/>check_ESCWN_%(species)s_c<sp/>AS<sp/>c<sp/>WHERE<sp/>g.trip==c.trip;</highlight></codeline>
<codeline lineno="33"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CREATE<sp/>INDEX<sp/>check_ESCWN_%(species)s_trip<sp/>ON<sp/>check_ESCWN_%(species)s(trip);</highlight></codeline>
<codeline lineno="34"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="35"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CREATE<sp/>TEMPORARY<sp/>TABLE<sp/>check_ESCWN_%(species)s_e<sp/>AS<sp/>SELECT<sp/>event_key<sp/>FROM<sp/>fishing_event<sp/>WHERE<sp/>trip<sp/>IN<sp/>(SELECT<sp/>trip<sp/>FROM<sp/>check_ESCWN_%(species)s<sp/>WHERE<sp/>sum_green_weight&lt;sum_catch_weight*%(minimum)s<sp/>AND<sp/>trip<sp/>IS<sp/>NOT<sp/>NULL);</highlight></codeline>
<codeline lineno="36"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CREATE<sp/>INDEX<sp/>check_ESCWN_%(species)s_e_event_key<sp/>ON<sp/>check_ESCWN_%(species)s_e(event_key);</highlight></codeline>
<codeline lineno="37"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="38"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>INSERT<sp/>INTO<sp/>estimated_subcatch_changes<sp/>SELECT<sp/>id,&apos;CTN&apos;,&apos;catch_weight&apos;,catch_weight,catch_weight/%(average)s<sp/>FROM<sp/>estimated_subcatch<sp/>WHERE<sp/>species_code=&apos;%(species)s&apos;<sp/>AND<sp/>event_key<sp/>IN<sp/>(SELECT<sp/>event_key<sp/>FROM<sp/>check_ESCWN_%(species)s_e);</highlight></codeline>
<codeline lineno="39"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UPDATE<sp/>estimated_subcatch<sp/>SET<sp/>changed=&apos;CTN&apos;,<sp/>catch_weight=catch_weight/%(average)s<sp/>WHERE<sp/>species_code=&apos;%(species)s&apos;<sp/>AND<sp/>event_key<sp/>IN<sp/>(SELECT<sp/>event_key<sp/>FROM<sp/>check_ESCWN_%(species)s_e);</highlight></codeline>
<codeline lineno="40"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="41"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&apos;&apos;&apos;</highlight><highlight class="normal">%locals())</highlight></codeline>
<codeline lineno="42"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="43"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classtangagroomer_1_1checks__estimated__subcatch_1_1ESCWN_1a85bdfadf6750f5c5718fccc666e13bfe" kindref="member">summarise_</ref>(self):</highlight></codeline>
<codeline lineno="44"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">##Added<sp/>_<sp/>to<sp/>name<sp/>so<sp/>does<sp/>not<sp/>get<sp/>used<sp/>.<sp/>Just<sp/>a<sp/>holder<sp/>for<sp/>some<sp/>old<sp/>code.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="45"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rows<sp/>=<sp/>self.db.Rows(</highlight><highlight class="stringliteral">&apos;&apos;&apos;SELECT<sp/>dropped,count(*),sum(catch_weight)/1000<sp/>FROM<sp/>estimated_subcatch<sp/>WHERE<sp/>dropped<sp/>IS<sp/>NOT<sp/>NULL<sp/>GROUP<sp/>by<sp/>dropped<sp/></highlight></codeline>
<codeline lineno="46"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UNION<sp/>SELECT<sp/>changed,count(*),sum(catch_weight)/1000<sp/>FROM<sp/>estimated_subcatch<sp/>WHERE<sp/>changed<sp/>IS<sp/>NOT<sp/>NULL<sp/>GROUP<sp/>BY<sp/>changed;&apos;&apos;&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="47"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>checks<sp/>=<sp/>(</highlight></codeline>
<codeline lineno="48"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="stringliteral">&apos;CTN&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;Estimated<sp/>catch<sp/>entered<sp/>as<sp/>weight<sp/>instead<sp/>of<sp/>numbers<sp/>check&apos;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="50"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="namespacetangagroomer_1_1html_1affb03ef21b66ff4bb21fe7ad6cf6278d" kindref="member">FARTable</ref>(</highlight><highlight class="stringliteral">&quot;Summary<sp/>of<sp/>error<sp/>checks<sp/>on<sp/>estimated_subcatch<sp/>table.<sp/>Checks<sp/>are<sp/>tabulated<sp/>in<sp/>the<sp/>order<sp/>that<sp/>they<sp/>are<sp/>discussed<sp/>in<sp/>the<sp/>following<sp/>sections.&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="51"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="stringliteral">&apos;Code&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;Description&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;Records&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;Estimated<sp/>catch<sp/>(t)&apos;</highlight><highlight class="normal">),rows,checks)</highlight></codeline>
<codeline lineno="52"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="53"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>num<sp/>=<sp/>self.db.Value(</highlight><highlight class="stringliteral">&apos;&apos;&apos;SELECT<sp/>count(species)<sp/>FROM<sp/>estimated_subcatch_CTN;&apos;&apos;&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="54"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>num&gt;0:</highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>report<sp/>+=<sp/><ref refid="classtangagroomer_1_1html_1_1H2" kindref="compound">H2</ref>(</highlight><highlight class="stringliteral">&apos;&apos;&apos;3.1<sp/>Estimated<sp/>catch<sp/>entered<sp/>as<sp/>weight<sp/>instead<sp/>of<sp/>numbers<sp/>check<sp/>(CTN)&apos;&apos;&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="56"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>report<sp/>+=<sp/><ref refid="classtangagroomer_1_1html_1_1P" kindref="compound">P</ref>(</highlight><highlight class="stringliteral">&apos;&apos;&apos;For<sp/>a<sp/>few<sp/>species,<sp/>estimated<sp/>catch<sp/>should<sp/>be<sp/>recorded<sp/>in<sp/>numbers<sp/>rather<sp/>than<sp/>weights.<sp/><sp/>This<sp/>check<sp/>is<sp/>designed<sp/>to<sp/>find<sp/>and<sp/>change<sp/>those<sp/>records<sp/></highlight></codeline>
<codeline lineno="57"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>where<sp/>the<sp/>weight<sp/>was<sp/>recorded<sp/>instead<sp/>of<sp/>numbers.<sp/><sp/>This<sp/>is<sp/>done<sp/>by<sp/>comparing<sp/>the<sp/>estimated<sp/>catch<sp/>with<sp/>the<sp/>landings<sp/>for<sp/>each<sp/>trip<sp/>for<sp/>each<sp/>species.<sp/>If<sp/>the<sp/>ratio<sp/>of<sp/>landings<sp/>to<sp/>estimated<sp/>catch</highlight></codeline>
<codeline lineno="58"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>is<sp/>less<sp/>than<sp/>a<sp/>specified<sp/>threshold<sp/>then<sp/>the<sp/>estimated<sp/>catch<sp/>is<sp/>assumed<sp/>to<sp/>have<sp/>been<sp/>mis-reported<sp/>as<sp/>a<sp/>catch<sp/>weight<sp/>and<sp/>is<sp/>adjusted<sp/>by<sp/>dividing<sp/>by<sp/>a<sp/>specified<sp/>average<sp/>weight.&apos;&apos;&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="59"><highlight class="normal"></highlight></codeline>
<codeline lineno="60"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>species<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.db.Values(</highlight><highlight class="stringliteral">&apos;&apos;&apos;SELECT<sp/>species<sp/>FROM<sp/>estimated_subcatch_CTN;&apos;&apos;&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="61"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>report<sp/>+=<sp/><ref refid="classtangagroomer_1_1html_1_1H3" kindref="compound">H3</ref>(species)</highlight></codeline>
<codeline lineno="62"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="63"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>values<sp/>=<sp/>self.db.Values(</highlight><highlight class="stringliteral">&apos;&apos;&apos;SELECT<sp/>sum_green_weight/sum_catch_weight<sp/>FROM<sp/>estimated_subcatch_CTN_%s<sp/>WHERE<sp/>sum_catch_weight&gt;0<sp/>AND<sp/>sum_green_weight&gt;0;&apos;&apos;&apos;</highlight><highlight class="normal">%(species))</highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>values.sort()</highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p1,p5,median,p95,p99<sp/>=<sp/>Quantiles(values,at=[0.01,0.05,0.5,0.95,0.99])</highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>geomean<sp/>=<sp/>math.exp(sum([math.log(value)<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>value<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>values])/len(values))</highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>filename<sp/>=<sp/>str(</highlight><highlight class="stringliteral">&apos;summarize/estimated_subcatch_CTN_%s_hist.png&apos;</highlight><highlight class="normal">%(species))</highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>R.png(filename,600,400)</highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>R.hist([math.log10(value)<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>value<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>values<sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>value&gt;=p1<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>value&lt;=p99],breaks=30,main=</highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">,xlab=</highlight><highlight class="stringliteral">&apos;log10<sp/>(Landed<sp/>green<sp/>weight<sp/>/<sp/>Estimated<sp/>catch)&apos;</highlight><highlight class="normal">,ylab=</highlight><highlight class="stringliteral">&apos;Trips&apos;</highlight><highlight class="normal">,col=</highlight><highlight class="stringliteral">&apos;grey&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>R.legend(</highlight><highlight class="stringliteral">&quot;topright&quot;</highlight><highlight class="normal">,legend=[</highlight><highlight class="stringliteral">&apos;5th<sp/>percentile<sp/>=<sp/>%.2f&apos;</highlight><highlight class="normal">%p5,</highlight><highlight class="stringliteral">&apos;Median<sp/>=<sp/>%.2f&apos;</highlight><highlight class="normal">%median,</highlight><highlight class="stringliteral">&apos;Geometric<sp/>mean<sp/>=<sp/>%.2f&apos;</highlight><highlight class="normal">%geomean,</highlight><highlight class="stringliteral">&apos;95th<sp/>percentile<sp/>=<sp/>%.2f&apos;</highlight><highlight class="normal">%p95],bty=</highlight><highlight class="stringliteral">&apos;n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.groom_estimated_subcatch_catch<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:<sp/></highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>minimum,average<sp/>=<sp/>self.groom_estimated_subcatch_catch[species]</highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>R.abline(v=(math.log10(minimum),math.log10(average)),lty=(2,3),col=(</highlight><highlight class="stringliteral">&apos;red&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;blue&apos;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>R.legend(</highlight><highlight class="stringliteral">&quot;topleft&quot;</highlight><highlight class="normal">,legend=[</highlight><highlight class="stringliteral">&apos;Threshold<sp/>=<sp/>%s&apos;</highlight><highlight class="normal">%minimum,</highlight><highlight class="stringliteral">&apos;Average<sp/>=<sp/>%s&apos;</highlight><highlight class="normal">%average],lty=(2,3),col=(</highlight><highlight class="stringliteral">&apos;red&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;blue&apos;</highlight><highlight class="normal">),bty=</highlight><highlight class="stringliteral">&apos;n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>R.dev_off()</highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>report<sp/>+=<sp/>Figurate(src=filename)<sp/></highlight></codeline>
<codeline lineno="79"><highlight class="normal"></highlight></codeline>
    </programlisting>
    <location file="/home/nbentley/Trophia/Code/tangagroomer/checks_estimated_subcatch.py"/>
  </compounddef>
</doxygen>
