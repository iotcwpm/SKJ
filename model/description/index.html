<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<title>Model description</title>
		<meta charset="UTF-8" />
		<link rel="stylesheet" type="text/css" href="/core/stencils/themes/default/theme.css" />
		<script type="text/javascript">(function(c){
	var d=document,s,i,l;
	s=d.styleSheets;for(i=0;i!=s.length;i++){if(s[i].href.match(c)){try{if(s[i].cssRules.length)return;}catch(e){}}}
	l=d.createElement('link');l.rel='stylesheet';l.type='text/css';l.href='http://stenci.la'+c;
	d.documentElement.className='unready';l.onload=function(){d.documentElement.className='';};
	d.getElementsByTagName('head')[0].appendChild(l);
})('/core/stencils/themes/default/theme.css');</script>
		<style type="text/css">.unready{display:none;}</style>
	</head>
	<body>
		
		<main id="content">
			 
			<div id="title">Model description</div>
			<p>
				This documentation is a draft under active development. As such, it may not exactly mirror what is in the current version of the code. Separate documentation, generated from the model's C++ source code, is also 
				<a href="../../doxygen/html/index.html">available</a>
				.
			</p>
			<h1>Introduction</h1>
			<p>This document describes a simulation model for the skipjack fishery in the Indian Ocean. The model has been designed for use in simulation based evaluation of alternative management strategies for the fishery. This document outlines the structure of the model, describes prior probability distributions for model parameters, model conditioning algorithms and conditioning results.</p>
			<p>The model, and consequently this document, are under development. The general approach to model development has been to start simple and add complexity as required. Potential alternative model formulations are noted throughout the document.</p>
			<p>
				The following convention is used for assigning symbols for the model: Greek lower case letters (e.g. 
				<script type="math/asciimath">alpha</script>
				) for model parameters, Roman capital letters (e.g. 
				<script type="math/asciimath">N</script>
				) for model variables, and Roman lower case letters for variable or parameter array subscripts (e.g. 
				<script type="math/asciimath">N_{r,a,s}</script>
				, 
				<script type="math/asciimath">phi_{r}</script>
				). Using this convention means that in some instances model parameters are given different symbols that usual but has the advantage of clearly distinguishing model parameters (which are independent of other parameters or variables and are usually estimated) from model variables (which are dependent upon parameter values).
			</p>
			<p>
				The subscript for time, 
				<script type="math/asciimath">t</script>
				, is usually omitted from the model equations below except where it is necessary to be explicit regarding the time step involved.
			</p>
			<h1>Dimensions</h1>
			<p>Several dimensions are used to partition aspects of the model (e.g. fish numbers, catches).</p>
			<h2>Time</h2>
			<p>
				The model uses a quarterly, i.e. three month, time step (
				<script type="math/asciimath">t</script>
				). Each time step, 
				<script type="math/asciimath">t</script>
				, has an associated calendar year (
				<script type="math/asciimath">y</script>
				) and calendar quarter (
				<script type="math/asciimath">q</script>
				).
			</p>
			<h2>Region</h2>
			<p>
				There are three regions (
				<script type="math/asciimath">r</script>
				), West (
				<script type="math/asciimath">we</script>
				), Maldives (
				<script type="math/asciimath">ma</script>
				) and East (
				<script type="math/asciimath">ea</script>
				). The term "region" is used in preference to "area" because using the latter would confound the 
				<script type="math/asciimath">a</script>
				 subscript which is also used for age.
			</p>
			<h2>Age</h2>
			<p>
				Fish recruit to the model in each quarter and the model keeps track of their numbers by their age (
				<script type="math/asciimath">a</script>
				), in quarters up to six years i.e. 
				<script type="math/asciimath">0,1,2,...,23</script>
			</p>
			<h2>Size</h2>
			<p>
				Fish size (
				<script type="math/asciimath">s</script>
				) is represented in forty, 2cm bins, 
				<script type="math/asciimath">0-2, 2-4, ..., 78-80cm</script>
				.
			</p>
			<h2>Method</h2>
			<p>
				Five fishing methods (
				<script type="math/asciimath">m</script>
				) are defined (Table 1).
			</p>
			<table>
				<caption>
					<span class="label">
						<span class="type">Table</span>
						<span class="number">1</span>
						<span class="separator">:</span>
					</span>
					Symbols used for model dimensions
				</caption>
				<tr>
					<td>
						<script type="math/asciimath">t</script>
					</td>
					<td>Time step</td>
				</tr>
				<tr>
					<td>
						<script type="math/asciimath">y</script>
					</td>
					<td>Calendar year</td>
				</tr>
				<tr>
					<td>
						<script type="math/asciimath">q</script>
					</td>
					<td>Calendar quarter; 1 = Jan-Mar</td>
				</tr>
				<tr>
					<td></td>
				</tr>
				<tr>
					<td>
						<script type="math/asciimath">r</script>
					</td>
					<td>Region subscript</td>
				</tr>
				<tr>
					<td>
						<script type="math/asciimath">we</script>
					</td>
					<td>West region</td>
				</tr>
				<tr>
					<td>
						<script type="math/asciimath">ma</script>
					</td>
					<td>Maldives region</td>
				</tr>
				<tr>
					<td>
						<script type="math/asciimath">ea</script>
					</td>
					<td>East region</td>
				</tr>
				<tr>
					<td></td>
				</tr>
				<tr>
					<td>
						<script type="math/asciimath">a</script>
					</td>
					<td>Fish age group</td>
				</tr>
				<tr>
					<td>
						<script type="math/asciimath">vec(a)</script>
					</td>
					<td>Maximum age in the model</td>
				</tr>
				<tr>
					<td>
						<script type="math/asciimath">s</script>
					</td>
					<td>Fish size group</td>
				</tr>
				<tr>
					<td>
						<script type="math/asciimath">vec(s)</script>
					</td>
					<td>Largest size group in the model</td>
				</tr>
				<tr>
					<td></td>
				</tr>
				<tr>
					<td>
						<script type="math/asciimath">m</script>
					</td>
					<td>Fishing method subscript</td>
				</tr>
				<tr>
					<td>
						<script type="math/asciimath">ps</script>
						 
					</td>
					<td>Purse seine</td>
				</tr>
				<tr>
					<td>
						<script type="math/asciimath">pl</script>
					</td>
					<td>Pole and line</td>
				</tr>
				<tr>
					<td>
						<script type="math/asciimath">gn</script>
						 
					</td>
					<td>Gill net</td>
				</tr>
				<tr>
					<td>
						<script type="math/asciimath">li</script>
					</td>
					<td>Line</td>
				</tr>
				<tr>
					<td>
						<script type="math/asciimath">ot</script>
						 
					</td>
					<td>Other</td>
				</tr>
			</table>
			<h1>Fish</h1>
			<h2>Numbers</h2>
			<p>
				Fish numbers are partitioned by region, age and size, 
				<script type="math/asciimath">N_{r,a,s}</script>
				. In each quarter, recruitment to the model and ageing occur as follows.
			</p>
			<p>
				The maximum age group, 
				<script type="math/asciimath">vec(a)</script>
				, accumulates fish from the previous age, 
				<script type="math/asciimath">vec(a)-1</script>
				,
			</p>
			<p class="equation">
				<script type="math/asciimath; mode=display">N_{r,vec(a),s} = N_{r,vec(a),s} + N_{r,vec(a)-1,s}</script>
			</p>
			<p>
				For ages 
				<script type="math/asciimath">1</script>
				 to 
				<script type="math/asciimath">vec(a)-1</script>
				, simple ageing occurs, 
			</p>
			<p class="equation">
				<script type="math/asciimath; mode=display">N_{r,a,s} = N_{r,a-1,s}</script>
			</p>
			<p>
				For age 
				<script type="math/asciimath">0</script>
				, recruitment occurs,
			</p>
			<p class="equation">
				<script type="math/asciimath; mode=display">N_{r,0,s} = R_{r,s}</script>
			</p>
			<p>
				where 
				<script type="math/asciimath">R_{r,s}</script>
				 is the number of fish recruiting to age 0 in region 
				<script type="math/asciimath">r</script>
				 at size 
				<script type="math/asciimath">s</script>
				.
			</p>
			<p>Numbers are updated by applying growth, survival, exploitation and movement. The numbers in each region, in each age class and size class are determined by summing over all regions and size classes,</p>
			<p class="equation">
				<script type="math/asciimath; mode=display">N_{r,a,s} = sum_{dot(r) in {we,ma,ea},dot(s)=0...vec(s)}( dot(N)_{dot(r),a,dot(s)} G_{dot(s),s} D (1-E_{dot(r),dot(s)}) M_{dot(r),r} )</script>
			</p>
			<p>
				where 
				<script type="math/asciimath">G</script>
				 is the growth transition matrix, 
				<script type="math/asciimath">D</script>
				 is the natural survival rate, 
				<script type="math/asciimath">E</script>
				 is the exploitation rate, and 
				<script type="math/asciimath">M</script>
				 is the movement transition matrix.
			</p>
			<h2>Length</h2>
			<p>
				The length of fish of size 
				<script type="math/asciimath">s</script>
				 is the midpoint of the bin size,
			</p>
			<p class="equation">
				<script type="math/asciimath; mode=display">L_s = 2s+1</script>
			</p>
			<h2>Weight</h2>
			<p>
				The weight of fish of size 
				<script type="math/asciimath">s</script>
				 is modelled as an exponential curve,
			</p>
			<p class="equation">
				<script type="math/asciimath; mode=display">W_s = alpha (L_s)^beta</script>
			</p>
			<div class="note">
				<p>
					Parameters of the length-weight relationship could vary by region i.e. 
					<script type="math/asciimath">alpha_{r}, beta_{r}</script>
				</p>
			</div>
			<h2>Maturity</h2>
			<p>
				The proportion of fish of size 
				<script type="math/asciimath">s</script>
				 that are mature is modelled as a logistic curve,
			</p>
			<p class="equation">
				<script type="math/asciimath; mode=display">O_s = 1/(1+19^(tau-L_s)/upsilon)</script>
			</p>
			<div class="note">
				<p>
					Maturity could be a function of age, rather than size, i.e. 
					<script type="math/asciimath">O_a</script>
					, and/or vary by region e.g. 
					<script type="math/asciimath">tau_{r}</script>
				</p>
			</div>
			<h2>Spawning</h2>
			<p>
				The proportion of mature fish that spawn in each quarter is allowed to vary according to a model parameter, 
				<script type="math/asciimath">rho_q</script>
				.
			</p>
			<h2>Recruitment</h2>
			<p>
				Recruitment occurs in each quarter and is partitioned by region and size, 
				<script type="math/asciimath">R_{r,s}</script>
				. The total number of recruits is based on the total spawning biomass in the previous quarter,
			</p>
			<p class="equation">
				<script type="math/asciimath; mode=display">S = sum_{r in {we,ma,ea},a=0...vec(a),s=0...vec(s)} N_{r,a,s} O_s W_s rho_q</script>
			</p>
			<p>
				where 
				<script type="math/asciimath">O_s</script>
				 is the proportion of fish that are mature at size 
				<script type="math/asciimath">s</script>
				, 
				<script type="math/asciimath">W_s</script>
				 is the weight of fish at size 
				<script type="math/asciimath">s</script>
				, and 
				<script type="math/asciimath">rho_q</script>
				 is the proportion of fish that spawn in quarter 
				<script type="math/asciimath">q</script>
				.
			</p>
			<p>
				The total spawning biomass is used as the basis for determining a recruitment over all three regions, 
				<script type="math/asciimath">bar(R)</script>
				 based on the Beverton-Holt stock recruitment function,
			</p>
			<p class="equation">
				<script type="math/asciimath; mode=display">bar(R) = 4 eta theta S/((5 eta-1) S + dot(S)  (1-eta)) D_t</script>
			</p>
			<p>
				where 
				<script type="math/asciimath">eta</script>
				 is steepness, 
				<script type="math/asciimath">theta</script>
				 and 
				<script type="math/asciimath">dot(S)</script>
				 are the respectively the recruitment and spawning biomass in the absence of fishing, and 
				<script type="math/asciimath">D_t</script>
				 is the recruitment deviation at time t which is lognormally distributed with mean of 1 and standard deviation of 
				<script type="math/asciimath">sigma</script>
				.
			</p>
			<div class="todo">
				<p>To do : add in recruitment autocorrelation</p>
			</div>
			<p>This total recruitment is distributed across the three regions,</p>
			<p class="equation">
				<script type="math/asciimath; mode=display">R_{r,s} = bar(R) * chi_r * A_s</script>
			</p>
			<p>
				where 
				<script type="math/asciimath">chi_r</script>
				 is the proportion of recruits which recruit into region 
				<script type="math/asciimath">r</script>
				 and 
				<script type="math/asciimath">A_s</script>
				 is the proportion of recruits of size 
				<script type="math/asciimath">s</script>
				 which is based on a normal distribution with mean, 
				<script type="math/asciimath">mu</script>
				 and standard deviation 
				<script type="math/asciimath">zeta</script>
				,
			</p>
			<p class="equation">
				<script type="math/asciimath; mode=display">A_s = 1/sqrt(2 pi zeta^2) e^(-((L_s-mu)^2)// 2 zeta^2)</script>
			</p>
			<div class="note">
				<p>Currently, recruitment is pooled across all areas. This could be changed via a recruitment dispersal matrix.</p>
			</div>
			<h2>Natural mortality</h2>
			<p>
				The instantaneous rate of natural mortality at size 
				<script type="math/asciimath">s</script>
				 is modelled as a function of weight at size 
				<script type="math/asciimath">s</script>
				,
			</p>
			<p class="equation">
				<script type="math/asciimath; mode=display">M_s = nu W_s^gamma</script>
			</p>
			<p>
				To prevent 
				<script type="math/asciimath">M_s</script>
				 going to very high levels at low 
				<script type="math/asciimath">s</script>
				, 
				<script type="math/asciimath">M_s</script>
				 is restricted to be a maximum of 
				<script type="math/asciimath">M_10</script>
				 (i.e. the mortality at a length of 21cm). The survival rate in one quarter is thus,
			</p>
			<p class="equation">
				<script type="math/asciimath; mode=display">D_s = e^{-0.25 M_s}</script>
			</p>
			<h2>Growth</h2>
			<p>Growth is described using a size transition matrix which is calculated based on the von Bertallanfy growth function. The mean increment in one quarter is,</p>
			<p class="equation">
				<script type="math/asciimath; mode=display">I_s = (lambda-L_s)(1-e^{-0.25kappa})</script>
			</p>
			<p>
				Variation in growth is modelled as a normal distribution with a constant standard deviation, 
				<script type="math/asciimath">zeta</script>
				, and a coefficient of variation, 
				<script type="math/asciimath">varphi</script>
				, on the increment. The standard deviation of the growth increment for a fish of size 
				<script type="math/asciimath">s</script>
				 is thus,
			</p>
			<p class="equation">
				<script type="math/asciimath; mode=display">J_s = sqrt(zeta^2 + (varphi I_s)^2)</script>
			</p>
			<p>
				The proportion of fish growing from size 
				<script type="math/asciimath">dot(s)</script>
				 to size 
				<script type="math/asciimath">s</script>
				 in one quarter is thus,
			</p>
			<p class="equation">
				<script type="math/asciimath; mode=display">G_{dot(s),s} = int_{l=2s}^{l=2(s+1)} 1/(sqrt(2 pi) J_dot(s))e^(-(L_dot(s)+I_dot(s)-l)^2)/(2 (J_dot(s))^2)</script>
			</p>
			<div class="note">
				<p>
					Growth could vary by region and/or time e.g 
					<script type="math/asciimath">lambda_{r}</script>
					, 
					<script type="math/asciimath">kappa_{t}</script>
				</p>
			</div>
			<div class="note">
				<p>An alternative to the vonB model would be to use the two-stanza growth model and parameter estimates of Everson et al (2012).</p>
			</div>
			<h2>Movement</h2>
			<p>
				The proportion of fish moving from region 
				<script type="math/asciimath">dot(r)</script>
				 to region 
				<script type="math/asciimath">r</script>
				 in one quarter is described by the movement matrix defined by six off-diagonal parameters,
				<p class="equation">
					<script type="math/asciimath; mode=display">M_{dot(r),r} = [[1-omega_{ea,ma}-omega_{ea,we},omega_{ea,ma},omega_{ea,we}],[omega_{ma,ea},1-omega_{ma,ea}-omega_{ma,we},omega_{ma,we}],[omega_{we,ea},omega_{we,ma},1-omega_{we,ea}-omega_{we,ma}]]</script>
				</p>
			</p>
			<div class="note">
				<p>
					There could be separate movement parameters for each age (or size) e.g. 
					<script type="math/asciimath">omega_{ma,we,a}</script>
					, or more simply, the relative proportion of fish moving could vary by age (or size).
				</p>
			</div>
			<h1>Fishing</h1>
			<h2>Exploitation rate</h2>
			<p>
				The biomass that is vulnerable to each method, 
				<script type="math/asciimath">m</script>
				 in each region 
				<script type="math/asciimath">r</script>
				, is calculated by summing over ages and sizes,
			</p>
			<p class="equation">
				<script type="math/asciimath; mode=display">V_{r,m} = sum_{a=0,...,vec(a),s=0,...,vec(s)} N_{r,a,s} W_s P_{m,s}</script>
			</p>
			<p>
				where 
				<script type="math/asciimath">P_{m,s}</script>
				 is the relative selectivity of method 
				<script type="math/asciimath">m</script>
				 for fish of size, 
				<script type="math/asciimath">s</script>
				.
			</p>
			<div class="todo">
				<p>Determine best way to parameterize selectivity ogives e.g. logistic, splines etc.</p>
			</div>
			<p>
				The exploitation rate in region 
				<script type="math/asciimath">r</script>
				 of method 
				<script type="math/asciimath">m</script>
				 is then,
			</p>
			<p class="equation">
				<script type="math/asciimath; mode=display">E_{r,m} = C_{r,m}/V_{r,m}</script>
			</p>
		</main>
		<script src="/core/themes/boot.js"> </script>
		<script>if(!window.Stencila){window.StencilaHost='http://stenci.la';document.write(unescape('%3Cscript src="http://stenci.la/core/themes/boot.js"%3E%3C/script%3E'))}</script>
		<script>window.Stencila.Booter.theme('core/stencils/themes/default');</script>
		<script>window.setTimeout(function(){document.documentElement.className='';},10000)</script>
	</body>
</html>
