<!DOCTYPE html><html><head><title>Indian Ocean skipjack tuna model : Model description</title><meta charset="utf-8"><meta name="generator" content="Stencila 0.19-ga98db03-dirty"><meta name="viewport" content="width=device-width, initial-scale=1"><meta itemprop="type" content="stencil"><meta itemprop="address" content="/home/nokome/trophia/code/ioskj/model/description"><meta itemprop="version" content=""><meta itemprop="theme" content="core/stencils/themes/default"><link rel="stylesheet" type="text/css" href="/get/web/stencil.min.css"><script type="application/javascript">(function(c){var d=document,s,i,l;s=d.styleSheets;for(i=0;i!=s.length;i++){if((s[i].href||'').match(c)){try{if(s[i].cssRules.length)return;}catch(e){}}}l=d.createElement('link');l.rel='stylesheet';l.type='text/css';l.href='https://stenci.la'+c;d.documentElement.className='unready';l.onload=function(){d.documentElement.className='';};d.getElementsByTagName('head')[0].appendChild(l);})('/get/web/stencil.min.css');</script><style type="text/css">.unready{display:none;}</style><meta itemprop="contexts" content="r"></head><body><main id="content"><div id="title">Indian Ocean skipjack tuna model : Model description</div><pre data-exec="r" data-hash="sKeinDB">
source('../../common.R',local=T)
</pre><p>The following convention is used for assigning symbols in the following model equations: Greek lower case letters (e.g. <script type="math/asciimath">alpha</script> for the intercept of the length-weight relationship) for model parameters, Roman capital letters (e.g. <script type="math/asciimath">N</script> for numbers) for model variables, and Roman lower case letters for variable or parameter array subscripts (e.g. <script type="math/asciimath">N_{r,a,s}</script>, <script type="math/asciimath">phi_{r}</script>). Using this convention means that in some instances model parameters are given different symbols than are usually used. However, it has the advantage of clearly distinguishing model parameters (which are independent of other parameters or variables and that are usually estimated) from model variables (which are dependent upon parameter values).</p><p>The subscript for time, <script type="math/asciimath">t</script>, is usually omitted from the model equations below except where it is necessary to be explicit regarding the time step involved.</p><p>As well as documenting the current structure of the model, this section also notes where potential changes could be made.  Usually, these potential changes would make the model more complex. Our approach has been to start simple and add complexity where necessary, in particular, in response to comments and suggestions from IOTC working parties.</p><section id="dimensions"><h1>Dimensions</h1><p>Several dimensions are used to partition aspects of the model (e.g. fish numbers, catches). <span data-refer="#table-dimensions"><a href="#table-dimensions">Table 1</a></span> provides the symbols associated with each of these dimensions.</p><section id="time"><h1>Time</h1><p>The model uses a quarterly, i.e. three month, time step (<script type="math/asciimath">t</script>). Each time step, <script type="math/asciimath">t</script>, has an associated calendar year (<script type="math/asciimath">y</script>) and calendar quarter (<script type="math/asciimath">q in 0,1,2,3</script>).</p></section><section id="regions"><h1>Regions</h1><p>Four regions (<script type="math/asciimath">r</script>) are defined, South-West (<script type="math/asciimath">sw</script>), North-West (<script type="math/asciimath">mw</script>), Maldives (<script type="math/asciimath">ma</script>) and East (<script type="math/asciimath">ea</script>) (<span data-refer="#figure-regions"><a href="#figure-regions">Figure 1</a></span>). The term "region" is used in preference to "area" because using the latter would confound the <script type="math/asciimath">a</script> subscript which is also used for age. </p><p>Initially three regions were defined mostly on the basis of differences in the main fishing gears used in each: purse-seine in the west, pole-and-line in the Maldives, and gill-net in the east. Although the Maldives is a small region spatially, it accounts for a large proportion of the total catch (see later sections). A three region structure also provided alignment between the model structure and the two available abundance indices, CPUE from the western purse seine fleet and CPUE from the Maldive pole-and-line fleet.</p><p>There is little information available on biological stock definitions for Indian Ocean skipjack tuna. However, based on what information is available, Fonteneau (2014), suggested four regions be used for future models, with the western region divided into northern and southern regions at the equator. Following this suggestion, in 2015, the western region was divided into separate south-west (SW) and north-west (NW) regions. The spatial distribution of catches by the EU purse seine fleet shows a strong discontinuity of the catch distribution at -10 degrees south (<span data-refer="#figure-regions"><a href="#figure-regions">Figure 1</a></span>) so the western region was divided on this basis rather than at the equator.</p></section><section id="fish-age-and-size"><h1>Fish age and size</h1><p>Fish recruit to the model in each quarter and the model keeps track of their numbers by their age (<script type="math/asciimath">a</script>), in quarters up to six years i.e. <script type="math/asciimath">0,1,2,...,23</script>. Fish size (<script type="math/asciimath">s</script>) is represented in forty, 2cm bins, <script type="math/asciimath">0-2, 2-4, ..., 78-80cm</script>.</p></section><section id="fishing-methods"><h1>Fishing methods</h1><p>Four fishing methods (i.e. gears) (<script type="math/asciimath">m</script>) are defined : purse seine (<script type="math/asciimath">ps</script>), pole and line (<script type="math/asciimath">pl</script>), gill net (<script type="math/asciimath">gn</script>) and other (<script type="math/asciimath">ot</script>). There are differences in the size distribution of free-school and associated-school purse seine sets. However, given the low proportion of free-school sets, particularly in recent years, it was considered unnecessary to model these subcomponents separately.</p></section><table id="table-dimensions" data-index="1"><caption><span data-label="table-1">Table 1</span>Summary of model dimensions and symbols used for each.</caption><thead><tr><th>Symbol</th><th>Description</th></tr></thead><tbody><tr><td>Time</td><td></td></tr><tr><td><script type="math/asciimath">t</script></td><td>Time step</td></tr><tr><td><script type="math/asciimath">y</script></td><td>Calendar year</td></tr><tr><td><script type="math/asciimath">q</script></td><td>Calendar quarter; 1 = Jan-Mar</td></tr><tr><td>Regions</td><td></td></tr><tr><td><script type="math/asciimath">r</script></td><td>Region subscript</td></tr><tr><td><script type="math/asciimath">sw</script></td><td>South-west region</td></tr><tr><td><script type="math/asciimath">nw</script></td><td>North-west region</td></tr><tr><td><script type="math/asciimath">ma</script></td><td>Maldives region</td></tr><tr><td><script type="math/asciimath">ea</script></td><td>East region</td></tr><tr><td>Fish age and size</td><td></td></tr><tr><td><script type="math/asciimath">a</script></td><td>Fish age group</td></tr><tr><td><script type="math/asciimath">vec(a)</script></td><td>Maximum age in the model</td></tr><tr><td><script type="math/asciimath">s</script></td><td>Fish size group</td></tr><tr><td><script type="math/asciimath">vec(s)</script></td><td>Largest size group in the model</td></tr><tr><td>Fishing methods</td><td></td></tr><tr><td><script type="math/asciimath">m</script></td><td>Fishing method subscript</td></tr><tr><td><script type="math/asciimath">ps</script> </td><td>Purse seine</td></tr><tr><td><script type="math/asciimath">pl</script></td><td>Pole and line</td></tr><tr><td><script type="math/asciimath">gn</script> </td><td>Gill net</td></tr><tr><td><script type="math/asciimath">ot</script> </td><td>Other</td></tr></tbody></table><figure id="figure-regions" data-index="1"><pre data-exec="r format png size 20x20cm" data-hash="siljqMA">

	# Region polygon definitions
regions &lt;- read.table('../../data/area-polygons.txt',header=T)
names(regions) &lt;- c('region','lat','lon')
# Catches with lats and lons
catches &lt;- read.table('../../data/input/catch_distr.tsv',header=T)
names(catches) &lt;- c('method','lat','lon','catch')
# Catches with no lats and lons
catches_other &lt;- read.table('../../data/input/catch_distr_other.tsv',header=T)
names(catches_other) &lt;- c('fleet','region','method','catch')
# Assign some nominal lat/lons
catches_other &lt;- merge(catches_other,read.table(text='
fleet	region	method	lat	lon
IDN	EA	PL	0	95
IDN	EA	GN	-2	97
IDN	EA	OT	-4	99
IDN	EA	PS	-6	101
IND	W	PS	19	72
IND	W	GN	17	72
IND	W	OT	15	72
IND	W	PL	13	72
IND	EA	PS	19	83
IND	EA	GN	17	83
IND	EA	OT	15	83
IRN	W	PS	24	60
IRN	W	GN	22	62
LKA	EA	PS	5	78
LKA	EA	PL	5	80
LKA	EA	OT	5	82
LKA	EA	GN	5	84
PAK	W	GN	23	66
',header=T))
catches_other$fleet &lt;- NULL
catches_other$region &lt;- NULL
catches &lt;- rbind(catches,catches_other)

print(
	ggplot(subset(map_data("world"),long&gt;30 &amp; long&lt;130 &amp; lat&lt;30 &amp; lat&gt;-40)) +
		geom_polygon(data=regions,aes(x=lon,y=lat,group=region),fill='white',colour='grey30',alpha=0.5) +
		geom_polygon(aes(x=long, y=lat, group=group),fill='white',colour='grey60') +
		geom_point(data=catches,aes(x=lon,y=lat,size=catch,color=method),alpha=0.5) + 
		scale_size_area(max_size=22,breaks=c(0,5000,10000,50000)) + 
		coord_map('mercator',xlim=c(35,122),ylim=c(-32,27)) + 
		labs(colour='Method',size='Catch (t/y)',x='',y='') + 
		theme(legend.position="top")
)
</pre><div data-out="true"><img src="out/figure-regions-map-of-the-four-regions-d-siljqMA.png" style="max-width:20cm;max-height:20cm"></div><figcaption><span data-label="figure-1">Figure 1</span>Map of the four regions defined for the model and the spatial distribution of average annual catch by method, 2005-2014. The position of catches from the western purse-seine and the Maldive pole-and-line fisheries is based on reported latitude and longitudes. The position of other catches is indicative only and only shown for the main coastal nations catching skipjack - Indonesia, Sri Lanka, India, Pakistan and Iran.</figcaption></figure></section><section id="fish-population-dynamics"><h1>Fish population dynamics</h1><section id="numbers"><h1>Numbers</h1><p>Fish numbers are partitioned by region and age <script type="math/asciimath">N_{r,a}</script>. In each quarter, recruitment to the model and ageing occur as follows.</p><p>The maximum age group, <script type="math/asciimath">vec(a)</script>, accumulates fish from the previous age, <script type="math/asciimath">vec(a)-1</script>,</p><div data-equation="true"><script type="math/asciimath; mode=display">N_{r,vec(a)} = N_{r,vec(a)} + N_{r,vec(a)-1}</script></div><p>For ages <script type="math/asciimath">1</script> to <script type="math/asciimath">vec(a)-1</script>, simple ageing occurs, </p><div data-equation="true"><script type="math/asciimath; mode=display">N_{r,a} = N_{r,a-1}</script></div><p>For age <script type="math/asciimath">0</script>, recruitment occurs,</p><div data-equation="true"><script type="math/asciimath; mode=display">N_{r,0} = R_{r}</script></div><p>where <script type="math/asciimath">R_{r}</script> is the number of fish recruiting to age 0 in region <script type="math/asciimath">r</script>.</p><p>Numbers are updated in each quarter by applying natural mortality, movement, and fishing mortality as described in the following subsections.</p></section><section id="growth"><h1>Growth</h1><p>The distribution of lengths at age is modelled as a normal distribution with a mean and standard deviation,</p><div data-equation="true"><script type="math/asciimath; mode=display">L_a ~ N(mu,sigma)</script></div><p>Mean length at age is determined from the two-stanza growth model and parameter estimates of Everson et al (2012, 2014).</p><div data-equation="true"><script type="math/asciimath; mode=display">mu = lambda (1-e^(-kappa_2(a-a0))(1+e^(-phi*(a-a0-delta))/(1+e^(delta*phi)))^(-(kappa_2-kappa_1)/phi))</script></div><p>where <script type="math/asciimath">a0</script> age 0, <script type="math/asciimath">phi</script> is the steepness, <script type="math/asciimath">delta</script> is the inflection</p><p>The standard deviation of length at age is based ,</p><div data-equation="true"><script type="math/asciimath; mode=display">cv = growth_cv_0 + (growth_cv_old - growth_cv_0)/24</script></div><div data-equation="true"><script type="math/asciimath; mode=display">sd = mu*zeta</script></div><p>At present, it is assumed that growth is the same in all three regions. It is likely that in fact growth differs between regions in which case some, or all, of the growth parameters could vary by region e.g <script type="math/asciimath">lambda_{r}</script>.</p></section><section id="weight-and-maturity"><h1>Weight and maturity</h1><div data-equation="true"><script type="math/asciimath; mode=display">L_s = 2s+1</script></div><p>The weight of fish of size <script type="math/asciimath">s</script> is modelled as an exponential curve,</p><div data-equation="true"><script type="math/asciimath; mode=display">W_s = alpha (L_s)^beta</script></div><div data-equation="true"><script type="math/asciimath; mode=display">W_a = sum_{s} W_s P_{a,s}</script></div><p>Currently, the model assumes that the parameters of the length-weight relationship are the same in the three regions. It is possible that condition factors consistently vary among regions, in which case these parameters could be made to vary by region i.e. <script type="math/asciimath">alpha_{r}, beta_{r}</script></p><p>The proportion of fish of size <script type="math/asciimath">s</script> that are mature is modelled as a logistic curve,</p><div data-equation="true"><script type="math/asciimath; mode=display">O_s = 1/(1+19^(tau-L_s)/upsilon)</script></div><p>Currently, the model assumes that the parameters of the maturity curve are the same in all three regions but could be made to vary by region i.e <script type="math/asciimath">tau_{r}, upsilon_{r}</script>. In addition, maturity could be modelled as a function of age, rather than size, i.e. <script type="math/asciimath">O_a</script>.</p></section><section id="spawning-and-recruitment"><h1>Spawning and recruitment</h1><p>The proportion of mature fish that spawn in each quarter is allowed to vary according to a quarterly parameter, <script type="math/asciimath">rho_q</script>. Currently, this parameter is the same for all regions. Evidence of regional differences in spawning seasonality would suggest making these parameters vary by region.</p><p>The biomass of mature fish is a function of the number of fish by age and size and the maturity and weight ogives by size,</p><div data-equation="true"><script type="math/asciimath; mode=display">B_r = sum_{a=0...vec(a),s=0...vec(s)} N_{r,a,s} O_s W_s</script></div><p>where <script type="math/asciimath">O_s</script> is the proportion of fish that are mature at size <script type="math/asciimath">s</script>, <script type="math/asciimath">W_s</script> is the weight of fish at size <script type="math/asciimath">s</script>. We refer to this variable as the "biomass of spawners" and it is used as the basis for determining stock status, i.e <script type="math/asciimath">B//B_{0}</script>. It differs from the "spawning biomass" it that it is independent of the seasonal spawning fraction.</p><p>The total number of eggs produced is based on the total spawning biomass,</p><div data-equation="true"><script type="math/asciimath; mode=display">E = sum_{r in {we,ma,ea}} B_r rho_q</script></div><p>where <script type="math/asciimath">rho_q</script> is the proportion of fish that spawn in quarter <script type="math/asciimath">q</script>.</p><p>The total number of eggs determines the total number of recruits over all three regions, <script type="math/asciimath">bar(R)</script> according to the Beverton-Holt stock recruitment function,</p><div data-equation="true"><script type="math/asciimath; mode=display">bar(R) = 4 eta theta E/((5 eta-1) E + dot(E)  (1-eta)) D_t</script></div><p>where <script type="math/asciimath">eta</script> is steepness, <script type="math/asciimath">theta</script> and <script type="math/asciimath">dot(E)</script> are the respectively the number of recruit and eggs in the absence of fishing, and <script type="math/asciimath">D_t</script> is the recruitment deviation at time t which is lognormally distributed with mean of 1 and standard deviation of <script type="math/asciimath">sigma</script>.</p><p>This total recruitment is distributed across the three regions,</p><div data-equation="true"><script type="math/asciimath; mode=display">R_{r,s} = bar(R) * chi_r * A_s</script></div><p>where <script type="math/asciimath">chi_r</script> is the proportion of recruits which recruit into region <script type="math/asciimath">r</script> and <script type="math/asciimath">A_s</script> is the proportion of recruits that are at size <script type="math/asciimath">s</script> which is based on a normal distribution with mean, <script type="math/asciimath">mu</script> and standard deviation <script type="math/asciimath">zeta</script>,</p><div data-equation="true"><script type="math/asciimath; mode=display">A_s = 1/sqrt(2 pi zeta^2) e^(-((L_s-mu)^2)// 2 zeta^2)</script></div></section><section id="natural-mortality"><h1>Natural mortality</h1><p>The instantaneous rate of natural mortality at size <script type="math/asciimath">s</script> is modelled as a function of weight at size <script type="math/asciimath">s</script> using the form of Lorenzen,</p><div data-equation="true"><script type="math/asciimath; mode=display">M_s = nu W_s^gamma</script></div><p>To prevent <script type="math/asciimath">M_s</script> going to very high levels at low <script type="math/asciimath">s</script>, <script type="math/asciimath">M_s</script> is restricted to be a maximum of <script type="math/asciimath">M_10</script> (i.e. the mortality at size bin 10, i.e. length of 21cm). </p><p>The rate of survival from natural mortality in one quarter of a fish of size <script type="math/asciimath">s</script>, is,</p><div data-equation="true"><script type="math/asciimath; mode=display">D_s = e^{-0.25 M_s}</script></div></section><section id="movement"><h1>Movement</h1><p>The movement of fish among the four regions can be described using a matrix of the proportion of fish moving from region <script type="math/asciimath">dot(r)</script> to region <script type="math/asciimath">r</script> in one quarter. This matrix potentially has twelve parameters (since the parameters are proportions the diagonal elements are determined from the other elements in the row). To reduce the number of parameters, we make some simplifying assumptions:</p><ul><li>that movement between two adjacent areas is non-directional (i.e. that the proportion of fish in the MA region that move to the NW region is the same as the proportion of fish in the MA region that move to the NW region),</li><li>that there is no direct movement within one quarter between SW and MA, and between SW and EA (i.e. that the movement parameters for these pairs are zero)</li></ul><p>The movement parameter matrix thus becomes:</p><div data-equation="true"><script type="math/asciimath; mode=display">M_{dot(r),r} = [[1-omega_{sw,nw},omega_{sw,nw},0,0],[omega_{sw,nw},1-omega_{sw,nw}-omega_{nw,ma}-omega_{nw,ea},omega_{nw,ma},omega_{nw,ea}],[0,omega_{nw,ma},1-omega_{nw,ma}-omega_{ma,ea},omega_{ma,ea}],[0,omega_{nw,ea},omega_{ma,ea},1-omega_{nw,ea}-omega_{ma,ea}]]</script></div><p>defined by the parameters <script type="math/asciimath">omega_{sw,nw}</script>, <script type="math/asciimath">omega_{nw,ma}</script>, <script type="math/asciimath">omega_{nw,ea}</script>, <script type="math/asciimath">omega_{ma,ea}</script>.</p><p>Currently, movement is uniform across all ages and sizes. An alternative would be to have separate movement parameters for each age or size e.g. <script type="math/asciimath">omega_{nw,ma,a}</script>, or more simply, to model the relative proportion of fish moving as varying by age or size. Also, currently there is no seasonal movement.</p></section><p>In summary, at present, whilst the model keeps account of fish numbers by region, only two of the biological characteristics of the stock vary by region: the proportion of recruitment going to each and the movement between each. As noted above, many of the model's parameters could be made to vary by region but this is likely to be of little value without information with which to inform how much those parameters should vary by region.</p></section><section id="fishing-dynamics"><h1>Fishing dynamics</h1><p>The biomass that is vulnerable to each method, <script type="math/asciimath">m</script> in each region <script type="math/asciimath">r</script>, is calculated by summing over ages and sizes,</p><div data-equation="true"><script type="math/asciimath; mode=display">V_{r,m} = sum_{a=0,...,vec(a),s=0,...,vec(s)} N_{r,a,s} W_s P_{m,s}</script></div><p>where <script type="math/asciimath">P_{m,s}</script> is the relative selectivity of method <script type="math/asciimath">m</script> for fish of size, <script type="math/asciimath">s</script>. </p><p>Selectivity is modelled as a function of length using a piecewise spline with knots at every ten centimeters from 20cm to 80cm.</p><p>Catches are compiled by region and method, <script type="math/asciimath">C_{r,m}</script> from IOTC data. The exploitation rate in region <script type="math/asciimath">r</script> of method <script type="math/asciimath">m</script> is then,</p><div data-equation="true"><script type="math/asciimath; mode=display">E_{r,m} = C_{r,m}/V_{r,m}</script></div></section></main><script src="/get/web/stencil.min.js"> </script><script type="application/javascript">if(!window.Stencila){window.StencilaHost="https://stenci.la";document.write(unescape('%3Cscript src="https://stenci.la/get/web/stencil.min.js"%3E%3C/script%3E'))}</script><script>window.setTimeout(function(){document.documentElement.className='';if(!window.Stencila){window.alert('Page could not be fully loaded. Not all functionality will be available.');}},10000)</script></body></html>