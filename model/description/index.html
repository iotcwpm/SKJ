<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<title>
			Indian Ocean skipjack model : Model description
		</title>
		<meta charset="utf-8">
		<meta name="generator" content="Stencila 0.15">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta itemprop="type" content="stencil">
		<meta itemprop="address" content="model/description">
		<meta itemprop="version" content="">
		<meta itemprop="theme" content="core/stencils/themes/default">
		<link rel="stylesheet" type="text/css" href="/core/stencils/themes/default/theme.min.css"><script type="text/javascript">(function(c){var d=document,s,i,l;s=d.styleSheets;for(i=0;i!=s.length;i++){if((s[i].href||'').match(c)){try{if(s[i].cssRules.length)return;}catch(e){}}}l=d.createElement('link');l.rel='stylesheet';l.type='text/css';l.href='https://stenci.la'+c;d.documentElement.className='unready';l.onload=function(){d.documentElement.className='';};d.getElementsByTagName('head')[0].appendChild(l);})('/core/stencils/themes/default/theme.min.css');</script>
		<style type="text/css">
			.unready{display:none;}
		</style>
		<meta itemprop="closed" content="false">
		<meta itemprop="contexts" content="r">
	</head>
	<body>
		<main id="content">
			 
			<div id="title">
				Indian Ocean skipjack model : Model description
			</div>
			<pre data-exec="r" data-hash="ry3QKIM">
source('../../common.R',local=T)

</pre>
			<p>
				The following convention is used for assigning symbols in the following model equations: Greek lower case letters (e.g. <script type="math/asciimath">alpha</script>) for model parameters, Roman capital letters (e.g. <script type="math/asciimath">N</script>) for model variables, and Roman lower case letters for variable or parameter array subscripts (e.g. <script type="math/asciimath">N_{r,a,s}</script>, <script type="math/asciimath">phi_{r}</script>). Using this convention means that in some instances model parameters are given different symbols that usual. However, it has the advantage of clearly distinguishing model parameters (which are independent of other parameters or variables and are usually estimated) from model variables (which are dependent upon parameter values).
			</p>
			<p>
				The subscript for time, <script type="math/asciimath">t</script>, is usually omitted from the model equations below except where it is necessary to be explicit regarding the time step involved.
			</p>
			<section>
				<h1>
					Dimensions
				</h1>
				<p>
					Several dimensions are used to partition aspects of the model (e.g. fish numbers, catches). See <span data-refer="#table-dimensions"><a href="#table-dimensions">Table  1</a></span> for symbols used for each.
				</p>
				<p>
					The model uses a quarterly, i.e. three month, time step (<script type="math/asciimath">t</script>). Each time step, <script type="math/asciimath">t</script>, has an associated calendar year (<script type="math/asciimath">y</script>) and calendar quarter (<script type="math/asciimath">q in 0,1,2,3</script>).
				</p>
				<p>
					There are three regions (<script type="math/asciimath">r</script>), West (<script type="math/asciimath">we</script>), Maldives (<script type="math/asciimath">ma</script>) and East (<script type="math/asciimath">ea</script>) (<span data-refer="#figure-regions"><a href="#figure-regions">Figure  1</a></span>). The term "region" is used in preference to "area" because using the latter would confound the <script type="math/asciimath">a</script> subscript which is also used for age. The three regions were mostly defined based on difference is the main fishing gears used in each. There is little information available on biological stock definitions for Indian Ocean skipjack tuna. However, based on what is available, <span data-refer="#fontaneau-2014-skj-stocks" data-error="refer-missing(No matching element found)"></span>, suggested four regions, in which the western region is divided into northern and southern regions at the equator. Given the nature of the catch distribution and resolution of available data, this four region definition should be relatively straightforward to use in future revisions.
				</p>
				<p>
					Fish recruit to the model in each quarter and the model keeps track of their numbers by their age (<script type="math/asciimath">a</script>), in quarters up to six years i.e. <script type="math/asciimath">0,1,2,...,23</script>. Fish size (<script type="math/asciimath">s</script>) is represented in forty, 2cm bins, <script type="math/asciimath">0-2, 2-4, ..., 78-80cm</script>.
				</p>
				<p>
					Four fishing methods (<script type="math/asciimath">m</script>) are defined : purse seine (<script type="math/asciimath">ps</script>), pole and line (<script type="math/asciimath">pl</script>), gill net (<script type="math/asciimath">gn</script>) and other (<script type="math/asciimath">ot</script>). There are differences in the size distribution of free-school and associated-school purse seine sets. However, given the low proportion of free-school sets, particularly in recent years, it was considered unnecessary to model these subcomponents separately.
				</p>
				<table id="table-dimensions">
					<caption><span data-label="true"><span class="type">Table </span><span class="number">1</span><span class="separator">: </span></span>
						Summary of model dimensions and symbols used for each.
					</caption>
					<thead>
						<tr>
							<th>
								Symbol
							</th>
							<th>
								Description
							</th>
						</tr>
					</thead>
					<tbody>
						<tr>
							<td>
								Time
							</td>
							<td></td>
						</tr>
						<tr>
							<td><script type="math/asciimath">t</script>
							</td>
							<td>
								Time step
							</td>
						</tr>
						<tr>
							<td><script type="math/asciimath">y</script>
							</td>
							<td>
								Calendar year
							</td>
						</tr>
						<tr>
							<td><script type="math/asciimath">q</script>
							</td>
							<td>
								Calendar quarter; 1 = Jan-Mar
							</td>
						</tr>
						<tr>
							<td>
								Regions
							</td>
							<td></td>
						</tr>
						<tr>
							<td><script type="math/asciimath">r</script>
							</td>
							<td>
								Region subscript
							</td>
						</tr>
						<tr>
							<td><script type="math/asciimath">we</script>
							</td>
							<td>
								West region
							</td>
						</tr>
						<tr>
							<td><script type="math/asciimath">ma</script>
							</td>
							<td>
								Maldives region
							</td>
						</tr>
						<tr>
							<td><script type="math/asciimath">ea</script>
							</td>
							<td>
								East region
							</td>
						</tr>
						<tr>
							<td>
								Fish age and size
							</td>
							<td></td>
						</tr>
						<tr>
							<td><script type="math/asciimath">a</script>
							</td>
							<td>
								Fish age group
							</td>
						</tr>
						<tr>
							<td><script type="math/asciimath">vec(a)</script>
							</td>
							<td>
								Maximum age in the model
							</td>
						</tr>
						<tr>
							<td><script type="math/asciimath">s</script>
							</td>
							<td>
								Fish size group
							</td>
						</tr>
						<tr>
							<td><script type="math/asciimath">vec(s)</script>
							</td>
							<td>
								Largest size group in the model
							</td>
						</tr>
						<tr>
							<td>
								Fishing methods
							</td>
							<td></td>
						</tr>
						<tr>
							<td><script type="math/asciimath">m</script>
							</td>
							<td>
								Fishing method subscript
							</td>
						</tr>
						<tr>
							<td><script type="math/asciimath">ps</script>
								 
							</td>
							<td>
								Purse seine
							</td>
						</tr>
						<tr>
							<td><script type="math/asciimath">pl</script>
							</td>
							<td>
								Pole and line
							</td>
						</tr>
						<tr>
							<td><script type="math/asciimath">gn</script>
								 
							</td>
							<td>
								Gill net
							</td>
						</tr>
						<tr>
							<td><script type="math/asciimath">ot</script>
								 
							</td>
							<td>
								Other
							</td>
						</tr>
					</tbody>
				</table>
				<figure id="figure-regions">
					<pre data-exec="r format png size 17x13cm" data-hash="rFihhME" data-error="exception(maps package required for this functionality. Please install and try again.)">
regions &lt;- read.table('../../data/area-polygons.txt',header=T)
names(regions) &lt;- c('region','lat','lon')
	
print(
	ggplot(subset(map_data("world"),long>30 &amp; long&lt;130 &amp; lat&lt;30 &amp; lat>-40)) +
		geom_polygon(data=regions,aes(x=lon,y=lat,fill=region),colour='grey30',alpha=0.5) +
		geom_polygon(aes(x=long, y=lat, group=group),fill='white',colour='grey60') +
		scale_y_continuous('',expand=c(0,0)) +
		scale_x_continuous('',expand=c(0,0)) + 
		coord_map('mercator') + 
		labs(fill='Region')
)
</pre>
					<figcaption><span data-label="true"><span class="type">Figure </span><span class="number">1</span><span class="separator">: </span></span>
						Map of the three regions used in the model: Western (W,<script type="math/asciimath">we</script>), Maldives (M,<script type="math/asciimath">ma</script>), Eastern (E,<script type="math/asciimath">ea</script>).
					</figcaption>
				</figure>
			</section>
			<section>
				<h1>
					Fish
				</h1>
				<section>
					<h1>
						Numbers
					</h1>
					<p>
						Fish numbers are partitioned by region, age and size, <script type="math/asciimath">N_{r,a,s}</script>. In each quarter, recruitment to the model and ageing occur as follows.
					</p>
					<p>
						The maximum age group, <script type="math/asciimath">vec(a)</script>, accumulates fish from the previous age, <script type="math/asciimath">vec(a)-1</script>,
						<p class="equation"><script type="math/asciimath; mode=display">N_{r,vec(a),s} = N_{r,vec(a),s} + N_{r,vec(a)-1,s}</script>
						</p>
					</p>
					<p>
						For ages <script type="math/asciimath">1</script> to <script type="math/asciimath">vec(a)-1</script>, simple ageing occurs, 
						<p class="equation"><script type="math/asciimath; mode=display">N_{r,a,s} = N_{r,a-1,s}</script>
						</p>
					</p>
					<p>
						For age <script type="math/asciimath">0</script>, recruitment occurs,
						<p class="equation"><script type="math/asciimath; mode=display">N_{r,0,s} = R_{r,s}</script>
						</p>
					</p>
					<p>
						where <script type="math/asciimath">R_{r,s}</script> is the number of fish recruiting to age 0 in region <script type="math/asciimath">r</script> at size <script type="math/asciimath">s</script>.
					</p>
					<p>
						Numbers are updated by applying growth, survival, exploitation and movement. The numbers in each region, in each age class and size class are determined by summing over all regions and size classes,
						<p class="equation"><script type="math/asciimath; mode=display">N_{r,a,s} = sum_{dot(r) in {we,ma,ea},dot(s)=0...vec(s)}( dot(N)_{dot(r),a,dot(s)} G_{dot(s),s} D (1-E_{dot(r),dot(s)}) M_{dot(r),r} )</script>
						</p>
					</p>
					<p>
						where <script type="math/asciimath">G</script> is the growth transition matrix, <script type="math/asciimath">D</script> is the natural survival rate, <script type="math/asciimath">E</script> is the exploitation rate, and <script type="math/asciimath">M</script> is the movement transition matrix (all described below).
					</p>
				</section>
				<section>
					<h1>
						Length, weight and maturity
					</h1>
					<p>
						The length of fish of size <script type="math/asciimath">s</script> is the midpoint of the 2mm bin size,
						<p class="equation"><script type="math/asciimath; mode=display">L_s = 2s+1</script>
						</p>
					</p>
					<p>
						The weight of fish of size <script type="math/asciimath">s</script> is modelled as an exponential curve,
						<p class="equation"><script type="math/asciimath; mode=display">W_s = alpha (L_s)^beta</script>
						</p>
					</p>
					<p>
						Currently, the model assumes that the parameters of the length-weight relationship are the same in the three regions. These seems a reasonable assumption, but it is possible that condition factors consistently vary among regions, in which case these parameters could be made to vary by region i.e. <script type="math/asciimath">alpha_{r}, beta_{r}</script>
					</p>
					<p>
						The proportion of fish of size <script type="math/asciimath">s</script> that are mature is modelled as a logistic curve,
						<p class="equation"><script type="math/asciimath; mode=display">O_s = 1/(1+19^(tau-L_s)/upsilon)</script>
						</p>
					</p>
					<p>
						Currently, the model assumes that the parameters of the maturity curve are the same in all three regions but could be made to vary by region i.e <script type="math/asciimath">tau_{r}, upsilon_{r}</script>. In addition, maturity could be modelled as a function of age, rather than size, i.e. <script type="math/asciimath">O_a</script>.
					</p>
				</section>
				<section>
					<h1>
						Spawning and recruitment
					</h1>
					<p>
						The proportion of mature fish that spawn in each quarter is allowed to vary according to a quarterly parameter, <script type="math/asciimath">rho_q</script>. Currently, this parameter is the same for all regions. Evidence of regional differences in spawning seasonality would suggest making these parameters vary by region.
					</p>
					<p>
						The biomass of mature fish is a function of the number of fish by age and size and the maturity and weight ogives by size,
						<p class="equation"><script type="math/asciimath; mode=display">B_r = sum_{a=0...vec(a),s=0...vec(s)} N_{r,a,s} O_s W_s</script>
						</p>
					</p>
					<p>
						We refer to this varable as the biomass of spawners and is used as the basis for determing stock status, <script type="math/asciimath">B/B_{0}</script>.
					</p>
					<p>
						Recruitment occurs in each quarter and is partitioned by region and size, <script type="math/asciimath">R_{r,s}</script>. The total number of eggs is based on the total spawning biomass in the previous quarter,
						<p class="equation"><script type="math/asciimath; mode=display">E = sum_{r in {we,ma,ea}} B_r rho_q</script>
						</p>
					</p>
					<p>
						where <script type="math/asciimath">O_s</script> is the proportion of fish that are mature at size <script type="math/asciimath">s</script>, <script type="math/asciimath">W_s</script> is the weight of fish at size <script type="math/asciimath">s</script>, and <script type="math/asciimath">rho_q</script> is the proportion of fish that spawn in quarter <script type="math/asciimath">q</script>.
					</p>
					<p>
						The total number of eggs determines the total number of recruits over all three regions, <script type="math/asciimath">bar(R)</script> using the Beverton-Holt stock recruitment function,
						<p class="equation"><script type="math/asciimath; mode=display">bar(R) = 4 eta theta E/((5 eta-1) E + dot(E)  (1-eta)) D_t</script>
						</p>
					</p>
					<p>
						where <script type="math/asciimath">eta</script> is steepness, <script type="math/asciimath">theta</script> and <script type="math/asciimath">dot(E)</script> are the respectively the number of recruit and eggs in the absence of fishing, and <script type="math/asciimath">D_t</script> is the recruitment deviation at time t which is lognormally distributed with mean of 1 and standard deviation of <script type="math/asciimath">sigma</script>.
					</p>
					<p>
						This total recruitment is distributed across the three regions,
						<p class="equation"><script type="math/asciimath; mode=display">R_{r,s} = bar(R) * chi_r * A_s</script>
						</p>
					</p>
					<p>
						where <script type="math/asciimath">chi_r</script> is the proportion of recruits which recruit into region <script type="math/asciimath">r</script> and <script type="math/asciimath">A_s</script> is the proportion of recruits of size <script type="math/asciimath">s</script> which is based on a normal distribution with mean, <script type="math/asciimath">mu</script> and standard deviation <script type="math/asciimath">zeta</script>,
						<p class="equation"><script type="math/asciimath; mode=display">A_s = 1/sqrt(2 pi zeta^2) e^(-((L_s-mu)^2)// 2 zeta^2)</script>
						</p>
					</p>
				</section>
				<section>
					<h1>
						Natural mortality
					</h1>
					<p>
						The instantaneous rate of natural mortality at size <script type="math/asciimath">s</script> is modelled as a function of weight at size <script type="math/asciimath">s</script> using the form of Lorenzen,
						<p class="equation"><script type="math/asciimath; mode=display">M_s = nu W_s^gamma</script>
						</p>
					</p>
					<p>
						To prevent <script type="math/asciimath">M_s</script> going to very high levels at low <script type="math/asciimath">s</script>, <script type="math/asciimath">M_s</script> is restricted to be a maximum of <script type="math/asciimath">M_10</script> (i.e. the mortality at size bin 10, i.e. length of 21cm). 
					</p>
					<p>
						The survival rate in one quarter is,
						<p class="equation"><script type="math/asciimath; mode=display">D_s = e^{-0.25 M_s}</script>
						</p>
					</p>
				</section>
				<section>
					<h1>
						Growth
					</h1>
					<p>
						Growth is described using a size transition matrix which is calculated based on the von Bertallanfy growth function. The mean increment in one quarter is,
						<p class="equation"><script type="math/asciimath; mode=display">I_s = (lambda-L_s)(1-e^{-0.25kappa})</script>
						</p>
					</p>
					<p>
						Variation in growth is modelled as a normal distribution with a constant standard deviation, <script type="math/asciimath">zeta</script>, and a coefficient of variation, <script type="math/asciimath">varphi</script>, on the increment. The standard deviation of the growth increment for a fish of size <script type="math/asciimath">s</script> is thus,
						<p class="equation"><script type="math/asciimath; mode=display">J_s = sqrt(zeta^2 + (varphi I_s)^2)</script>
						</p>
					</p>
					<p>
						The proportion of fish growing from size <script type="math/asciimath">dot(s)</script> to size <script type="math/asciimath">s</script> in one quarter is thus,
						<p class="equation"><script type="math/asciimath; mode=display">G_{dot(s),s} = int_{l=2s}^{l=2(s+1)} 1/(sqrt(2 pi) J_dot(s))e^(-(L_dot(s)+I_dot(s)-l)^2)/(2 (J_dot(s))^2)</script>
						</p>
					</p>
					<p>
						At present, it is assumed that growth is the same in all three regions. It is likely that in fact growth differs between regions in which case some, or all, of the growth parameters could vary by region e.g <script type="math/asciimath">lambda_{r}</script>, <script type="math/asciimath">kappa_{t}</script>.
					</p>
					<p>
						An alternative to the von Bertallanfy function would be to use the two-stanza growth model and parameter estimates of Everson et al (2012, 2014).
					</p>
				</section>
				<section>
					<h1>
						Movement
					</h1>
					<p>
						The proportion of fish moving from region <script type="math/asciimath">dot(r)</script> to region <script type="math/asciimath">r</script> in one quarter is described by the movement matrix defined by six off-diagonal parameters,
					</p>
					<p class="equation"><script type="math/asciimath; mode=display">M_{dot(r),r} = [[1-omega_{ea,ma}-omega_{ea,we},omega_{ea,ma},omega_{ea,we}],[omega_{ma,ea},1-omega_{ma,ea}-omega_{ma,we},omega_{ma,we}],[omega_{we,ea},omega_{we,ma},1-omega_{we,ea}-omega_{we,ma}]]</script>
					</p>
					<p>
						There could be separate movement parameters for each age (or size) e.g. <script type="math/asciimath">omega_{ma,we,a}</script>, or more simply, the relative proportion of fish moving could vary by age (or size).
					</p>
				</section>
				<p>
					In summary, at present, whilst the model keeps account of fish numbers by region, only two of the biological characteristics of the stock vary by region: the proportion of recruitment going to each and the movement between each. As noted above, many of the model's parameters could be made to vary by region but this is likely to be of little value without information with which to inform how much those parameters should vary by region.
				</p>
			</section>
			<section>
				<h1>
					Fishing
				</h1>
				<p>
					Selectivity is modelled as a function of length using a piecewise spline with knots at every ten cm from 20cm to 80cm.
				</p>
				<p>
					Catches are compiled by region and method, <script type="math/asciimath">C_{r,m}</script> from IOTC data. The biomass that is vulnerable to each method, <script type="math/asciimath">m</script> in each region <script type="math/asciimath">r</script>, is calculated by summing over ages and sizes,
					<p class="equation"><script type="math/asciimath; mode=display">V_{r,m} = sum_{a=0,...,vec(a),s=0,...,vec(s)} N_{r,a,s} W_s P_{m,s}</script>
					</p>
				</p>
				<p>
					where <script type="math/asciimath">P_{m,s}</script> is the relative selectivity of method <script type="math/asciimath">m</script> for fish of size, <script type="math/asciimath">s</script>.
				</p>
				<p>
					The exploitation rate in region <script type="math/asciimath">r</script> of method <script type="math/asciimath">m</script> is then,
					<p class="equation"><script type="math/asciimath; mode=display">E_{r,m} = C_{r,m}/V_{r,m}</script>
					</p>
				</p>
			</section>
		</main><script src="https://stenci.la/get/js/stencila-0.15.min.js"> </script><script>Stencila.launch();</script><script>window.setTimeout(function(){document.documentElement.className='';if(!window.Stencila){window.alert('Page could not be fully loaded. Not all functionality will be available.');}},10000)</script>
	</body>
</html>