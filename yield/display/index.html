<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<title>
			Indian Ocean skipjack model : yield curve and MSY
		</title>
		<meta charset="utf-8">
		<meta itemprop="generator" content="Stencila 0.14">
		<meta itemprop="type" content="stencil">
		<meta itemprop="address" content="yield/display">
		<meta itemprop="version" content="">
		<meta itemprop="theme" content="core/stencils/themes/default">
		<link rel="stylesheet" type="text/css" href="/core/stencils/themes/default/theme.min.css"><script type="text/javascript">(function(c){var d=document,s,i,l;s=d.styleSheets;for(i=0;i!=s.length;i++){if((s[i].href||'').match(c)){try{if(s[i].cssRules.length)return;}catch(e){}}}l=d.createElement('link');l.rel='stylesheet';l.type='text/css';l.href='https://stenci.la'+c;d.documentElement.className='unready';l.onload=function(){d.documentElement.className='';};d.getElementsByTagName('head')[0].appendChild(l);})('/core/stencils/themes/default/theme.min.css');</script>
		<style type="text/css">
			.unready{display:none;}
		</style>
		<meta itemprop="closed" content="false">
		<meta itemprop="contexts" content="r">
	</head>
	<body>
		<main id="content">
			 
			<div id="title">
				Indian Ocean skipjack model : yield curve and MSY
			</div>
			<pre data-exec="r" data-hash="b2HhLXd">
# Load in source and output files
source('../../common.R',local=T)
load(c(
	'curve','msy','per_recruit'
),from='../../yield/output')
load(c(
	'maturities','selectivities'
),from='../../model/output')

msy &lt;- within(msy,{
	status &lt;- biomass_spawners_msy/biomass_spawners_unfished
})

# Find B40% etc and insert MSY
points &lt;- NULL
points &lt;- rbind(points,curve[with(curve,which.min(abs(status-0.3))),c('exprate','f','yield','status')])
points &lt;- rbind(points,curve[with(curve,which.min(abs(status-0.4))),c('exprate','f','yield','status')])
points &lt;- rbind(points,curve[with(curve,which.min(abs(status-0.5))),c('exprate','f','yield','status')])
points &lt;- rbind(points,with(msy,c(e_msy,f_msy,msy,status)))
points$level &lt;- c('0.3','0.4','0.5','MSY')


# Normalise to per recruit
per_recruit$number &lt;- per_recruit$number/per_recruit$number[1]
# Calculate ypr
per_recruit$ypr &lt;- with(per_recruit,number*weight)
# Remove plus age
per_recruit &lt;- per_recruit[-nrow(per_recruit),]
# Find maximum
ypr_max_age  &lt;- with(per_recruit,age[which.max(ypr)])
ypr_max_length  &lt;- with(per_recruit,length[which.max(ypr)])

</pre>
			<section>
				<h1>
					Methods
				</h1>
				<p>
					The <code>ioskj.exe</code> executable has a <code>yield</code> task which generates outputs related to:
					<ul>
						<li>
							the yield curve
						</li>
						<li>
							maximum sustainable yield (MSY) 
						</li>
						<li>
							yield per recruit. 
						</li>
					</ul>
				</p>
				<p>
					The yield curve is the equilibrium catch as a function of exploitation rate. This is generated by the model's <code>yield_curve</code> method which takes the model to deterministic equilibrium under a range of exploitation rates from 0 to 1. MSY is determined by the model's <code>msy_find</code> method which uses Brent's minimisation algorithm to find the exploitation rate which maximises yield. 
				</p>
				<p>
					In a simple biomass dynamics model the entire fish population is assumed to be selected by the fishery and thus the yield curve and MSY are a function of only the biological parameters. In the current model, yield is a function of the biological parameters, the fishery selectivity parameters <b>and</b> the distribution of fishing effort (i.e. relative exploitation rates) across fisheries (i.e. region/method subsets). If the shape of the selectivity curves or the relative exploitation rates of the fisheries changes then both MSY and the shape of the yield curve will change. Currently, the yield curve and MSY are calculated assuming that the specified exploitation rate applies to the three main fisheries in each region, western purse seine (W-PS), Maldive pole-and-line (M-PL) and eastern gillnet (E-GN). For all other fisheries, the exploitation rate is assumed to be 0.
				</p>
				<p>
					The model's <code>yield_per_recruit</code> method calculates the numbers at age, mean length and weight at age from which a yield-per-recruit cureve can be derived.
				</p>
				<p>
					All of these yield related outputs are dependent on the parameters used. The results presented in this section are based on the reference parameter set (read in from files in the <code>parameters/input</code> folder). 
				</p>
				<p>
					The results presented here should be considered preliminary. They are based on the reference parameter set only and ideally their sensitivity to alternative parameter values should be investigated. Also, further checking and testing of the model's equilbrium dynamics used for generating these results should be done. The main intention of this section is to promote discusssion regarding the pros and cons of alternative type of reference points (e.g. <script type="math/asciimath">B_{msy}</script> v <script type="math/asciimath">B_{0}</script> based) for the Indian Ocean skipjack tuna fishery.
				</p>
			</section>
			<section>
				<h1>
					Overall yield curve and MSY
				</h1>
				<p>
					This section describes the overall yield curve and reference points related to maximising sustainable yield. <span data-refer="#table-msy-ref"><a href="#table-msy-ref">Table  1</a></span> provides MSY related reference points and <span data-refer="#table-biomass-ref"><a href="#table-biomass-ref">Table  2</a></span> provides reference points associated with alternative biomass levels. <span data-refer="#figure-yield-curve"><a href="#figure-yield-curve">Figure  1</a></span> presents plots of various variables related to the yield curve.
				</p>
				<table id="table-msy-ref">
					<caption><span data-label="true"><span class="type">Table </span><span class="number">1</span><span class="separator">: </span></span>
						Yield curve related variables determined from the reference parameter set.
					</caption>
					<thead>
						<tr>
							<th>
								Symbol
							</th>
							<th>
								Description
							</th>
							<th>
								Value	
							</th>
						</tr>
					</thead>
					<tbody data-with="msy">
						<tr>
							<td><script type="math/asciimath">E_{msy}</script>
							</td>
							<td>
								Exploitation rate which produces MSY (quarterly)
							</td>
							<td data-text="round(e_msy,3)">
								0.384
							</td>
						</tr>
						<tr>
							<td><script type="math/asciimath">F_{msy}</script>
							</td>
							<td>
								Instantaneous rate of fishing mortality which produces MSY (quarterly)
							</td>
							<td data-text="round(f_msy,3)">
								0.485
							</td>
						</tr>
						<tr>
							<td><script type="math/asciimath">C_{msy}</script>
							</td>
							<td>
								Maximum sustainable yield (quarterly)
							</td>
							<td data-text="msy">
								84515.8
							</td>
						</tr>
						<tr>
							<td><script type="math/asciimath">B_{msy}</script>
							</td>
							<td>
								Overall spawner biomass associated with maximum sustainable yield
							</td>
							<td data-text="biomass_spawners_msy">
								493244
							</td>
						</tr>
						<tr>
							<td><script type="math/asciimath">B_{msy}//B_{0}</script>
							</td>
							<td><script type="math/asciimath">B_{msy}</script>
								 as a percentage of pristine biomass
							</td>
							<td data-text="round(biomass_spawners_msy/biomass_spawners_unfished*100,1)">
								24.7
							</td>
						</tr>
						<tr>
							<td>
								-
							</td>
							<td>
								Number of iterations used to find MSY
							</td>
							<td data-text="msy_trials">
								8
							</td>
						</tr>
					</tbody>
				</table>
				<table id="table-biomass-ref">
					<caption><span data-label="true"><span class="type">Table </span><span class="number">2</span><span class="separator">: </span></span>
						Exploitation rate, instantaneous fishing mortality rate, and equilibrium yield associated with alternative biomass levels. Note that for <script type="math/asciimath">30%B_0</script> etc, values are approximate because they are taken from the yield curve generated from exploitation rates in increments of 0.05.
					</caption>
					<thead>
						<tr>
							<th>
								Biomass level
							</th>
							<th>
								Exploitation rate (quarterly)
							</th>
							<th>
								Fishing mortality rate (quarterly)
							</th>
							<th>
								Yield (quarterly)	
							</th>
							<th>
								Yield/MSY
							</th>
							<th><script type="math/asciimath">B//B_{msy}</script>
							</th>
							<th>
								Effort/Effort at MSY
							</th>
						</tr>
					</thead>
					<tbody>
						<tr data-with="msy">
							<td><script type="math/asciimath">B_{msy}</script>
							</td>
							<td data-text="round(e_msy,3)">
								0.384
							</td>
							<td data-text="round(f_msy,3)">
								0.485
							</td>
							<td data-text="round(msy)">
								84516
							</td>
							<td>
								1
							</td>
							<td>
								1
							</td>
							<td>
								1
							</td>
						</tr>
						<tr data-with="subset(points,level==0.3)">
							<td><script type="math/asciimath">30%B_0</script>
							</td>
							<td data-text="round(exprate,3)">
								0.3
							</td>
							<td data-text="round(f,3)">
								0.082
							</td>
							<td data-text="round(yield)">
								83477
							</td>
							<td data-text="round(yield/msy$msy,2)">
								0.99
							</td>
							<td data-text="round(status/msy$status,2)">
								1.22
							</td>
							<td data-text="round(exprate/msy$e_msy,3)">
								0.781
							</td>
						</tr>
						<tr data-with="subset(points,level==0.4)">
							<td><script type="math/asciimath">40%B_0</script>
							</td>
							<td data-text="round(exprate,3)">
								0.2
							</td>
							<td data-text="round(f,3)">
								0.053
							</td>
							<td data-text="round(yield)">
								77618
							</td>
							<td data-text="round(yield/msy$msy,2)">
								0.92
							</td>
							<td data-text="round(status/msy$status,2)">
								1.63
							</td>
							<td data-text="round(exprate/msy$e_msy,3)">
								0.52
							</td>
						</tr>
						<tr data-with="subset(points,level==0.5)">
							<td><script type="math/asciimath">50%B_0</script>
							</td>
							<td data-text="round(exprate,3)">
								0.15
							</td>
							<td data-text="round(f,3)">
								0.039
							</td>
							<td data-text="round(yield)">
								70972
							</td>
							<td data-text="round(yield/msy$msy,2)">
								0.84
							</td>
							<td data-text="round(status/msy$status,2)">
								1.94
							</td>
							<td data-text="round(exprate/msy$e_msy,3)">
								0.39
							</td>
						</tr>
					</tbody>
				</table>
				<figure id="figure-yield-curve">
					<pre data-exec="r format png size 17x20cm" data-hash="qROOz9D">
p1 = ggplot(curve,aes(x=exprate,y=yield/1000)) +
		geom_line() +
		geom_point(data=points,aes(x=exprate,y=yield/1000,colour=level),size=3) + 
		labs(x="Exploitation rate (quarterly)",y="Yield (kt, quarterly)") +
		theme(legend.position="none")
p2 = ggplot(curve,aes(x=status,y=yield/1000)) +
		geom_line() +
		geom_point(data=points,aes(x=status,y=yield/1000,colour=level),size=3) +
		labs(x="Status (B/B0)",y="Yield (kt, quarterly)") +
		theme(legend.position="none")
p3 = ggplot(curve,aes(x=exprate,y=status)) +
		geom_line() +
		geom_point(data=points,aes(x=exprate,y=status,colour=level),size=3) +
		labs(x="Exploitation rate (quarterly)", y="Status (B/B0)") +
		theme(legend.position="none")
multiplot(p1,p2,p3)
</pre><img src="figure-yield-curve-relations-between-equilib-qROOz9D.png" style="width:17cm;height:20cm" data-output="true">
					<figcaption><span data-label="true"><span class="type">Figure </span><span class="number">1</span><span class="separator">: </span></span>
						Relations between equilibrium yield, stock status and exploitation rate.(top) Equilibrium yield versus equilibrium exploitation rate. (middle) Equilibrium yield versus equilibrium stock status.(bottom) Equilibrium stock status versus equilibrium exploitation rate.
					</figcaption>
				</figure>
			</section>
			<section>
				<h1>
					Fishery-specific yield curves
				</h1>
				<p>
					Each fishing method has a particular size selectivity (<span data-refer="#figure-mat-select"><a href="#figure-mat-select">Figure  2</a></span>) and as such, the yield curve for each fishery will differ in shape. In this section we examine the shape of the yield curve for the three main fisheries. Rather than using the biomass of spawners in these fishery-specific yield curves we use the fishery-specific vulnerable biomass. Vulnerable biomass is directly proportional to catch rates so is a better measure of how alternative exploitation rates may affect the economic performance of the fishery. Each fishery will have a difference vulnerable biomass because of the different selectivity curve.
				</p>
				<p>
					For W-PS the yeild curve has its peak at high a much higher exploitation rate than for M-PL or E-GN (<span data-refer="#figure-yield-specific"><a href="#figure-yield-specific">Figure  3</a></span> top). This occurs because the W-PS fishery is selecting for smaller fish. Note also that the vulnerable biomass of all three fisheries is similar at very low exploitation rates. As exploitation rates increase the numbers of older, larger fish decreases and as such the vulnerable biomass of both M-PL ad E-GN decreases (<span data-refer="#figure-yield-specific"><a href="#figure-yield-specific">Figure  3</a></span> bottom).
				</p>
				<figure id="figure-mat-select">
					<pre data-exec="r format png size 17x10cm" data-hash="qKDGIW1">
print(
	ggplot() +
		geom_line(data=maturities,aes(x=length,y=value),colour='black',linetype=2) +
		geom_line(data=selectivities,aes(x=length,y=value,colour=method)) +
		labs(x="Length (cm)",y="Proportion mature / selected",colour="Method")
)
</pre><img src="figure-mat-select-maturity-at-length--dotte-qKDGIW1.png" style="width:17cm;height:10cm" data-output="true">
					<figcaption><span data-label="true"><span class="type">Figure </span><span class="number">2</span><span class="separator">: </span></span>
						Maturity at length (dotted line) and selectivity at length (by method).
					</figcaption>
				</figure>
				<figure id="figure-yield-specific">
					<pre data-exec="r format png size 17x20cm" data-hash="bdYve7Z">
p1 = ggplot(curve,aes(x=exprate)) +
		geom_line(aes(y=catch_w_ps/1000,colour="W-PS",linetype="W-PS")) +
		geom_line(aes(y=catch_m_pl/1000,colour="M-PL",linetype="M-PL")) +
		geom_line(aes(y=catch_e_gn/1000,colour="E-GN",linetype="E-GN")) +
		labs(x="Exploitation rate (quarterly)",y="Yield (kt, quarterly)",colour="",linetype="")
p2 = ggplot(curve) +
		geom_line(aes(x=vuln_w_ps/1e6,y=catch_w_ps/1000,colour="W-PS",linetype="W-PS")) +
		geom_line(aes(x=vuln_m_pl/1e6,y=catch_m_pl/1000,colour="M-PL",linetype="M-PL")) +
		geom_line(aes(x=vuln_e_gn/1e6,y=catch_e_gn/1000,colour="E-GN",linetype="E-GN")) +
		labs(x="Vulnerable biomass (Mt)",y="Yield (kt, quarterly)",colour="",linetype="")
p3 = ggplot(curve) +
		geom_line(aes(x=exprate,y=vuln_w_ps/1e6,colour="W-PS",linetype="W-PS")) +
		geom_line(aes(x=exprate,y=vuln_m_pl/1e6,colour="M-PL",linetype="M-PL")) +
		geom_line(aes(x=exprate,y=vuln_e_gn/1e6,colour="E-GN",linetype="E-GN")) +
		labs(x="Exploitation rate (quarterly)",y="Vulnerable biomass (Mt)",colour="",linetype="")		
multiplot(p1,p2,p3)
</pre><img src="figure-yield-specific-fishery-specific-yield-cu-bdYve7Z.png" style="width:17cm;height:20cm" data-output="true">
					<figcaption><span data-label="true"><span class="type">Figure </span><span class="number">3</span><span class="separator">: </span></span>
						Fishery specific yield curves. Each panel provides a separate line for each fishery (region/method) given that the specified exploitation rate is jointly applied in each fishery.
					</figcaption>
				</figure>
			</section>
			<section>
				<h1>
					Yield per recruit
				</h1>
				<p>
					To further investigate the nature of the yield in the fishery a simple yield per recruit analysis was done <span data-refer="#figure-yield-per-recruit"><a href="#figure-yield-per-recruit">Figure  4</a></span>. This suggests that yield per recruit is maximised at an age of 10 quarters (2.5 years) at a size of about 45cm. Note that this maximum will be highly dependent upon the growth curve and the mortality curve both of which are highly uncertain for fish below 45cm. As such, this analysis should be considered ancillary and treated with caution.
				</p>
				<figure id="figure-yield-per-recruit">
					<pre data-exec="r format png size 12x15cm" data-hash="bNJJu1H">
par(mfrow=c(4,1),mar=c(0,5,0,0),oma=c(5,0,1,1),las=1)
with(per_recruit,{
	plot(x=age,y=number,xaxt="n",ylab="Survival",type='l')
	abline(v=ypr_max_age,lty=2)
	plot(x=age,y=length,xaxt="n",ylab="Length (cm)",type='l')
	abline(v=ypr_max_age,lty=2)
	abline(h=ypr_max_length,lty=2)
	plot(x=age,y=weight,xaxt="n",ylab="Weight (kg)",type='l')
	abline(v=ypr_max_age,lty=2)
	plot(x=age,y=ypr,xaxt="n",ylab="Yield-per-recruit (kg)",type='l')
	abline(v=ypr_max_age,lty=2)
	axis(side=1,at=seq(0,20,4))
	mtext("Age (quarters)",side=1,outer=F,line=2,cex=0.7)
})
</pre><img src="figure-yield-per-recruit-yield-per-recruit-analysi-bNJJu1H.png" style="width:12cm;height:15cm" data-output="true">
					<figcaption><span data-label="true"><span class="type">Figure </span><span class="number">4</span><span class="separator">: </span></span>
						Yield per recruit analysis.
					</figcaption>
				</figure>
			</section>
		</main><script src="https://stenci.la/get/js/stencila-0.14.min.js"> </script><script>Stencila.launch();</script><script>window.setTimeout(function(){document.documentElement.className='';if(!window.Stencila){window.alert('Page could not be fully loaded. Not all functionality will be available.');}},10000)</script>
	</body>
</html>